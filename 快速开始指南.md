# A股指数分析系统 - 快速开始指南

python3 -m uvicorn src.api.main:app --reload --host 0.0.0.0 --port 8000

## 一、安装步骤

### 1. 检查Python版本

```bash
python --version
# 需要 Python 3.8 或更高版本
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

如果安装速度慢，可以使用国内镜像：

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 3. 配置环境变量

```bash
# 复制环境变量示例文件
cp .env.example .env

# 编辑 .env 文件（可选）
# 默认配置已经可以直接使用
```

### 4. 测试系统功能

```bash
python test_system.py
```

这个脚本会测试所有核心功能，确保系统正常运行。

### 5. 启动应用

```bash
python main.py
```

看到以下输出表示启动成功：

```
INFO:     Started server process
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### 6. 访问应用

打开浏览器访问：

- **Web界面**：http://localhost:8000
- **API文档**：http://localhost:8000/docs

## 二、使用指南

### Web界面使用

1. **选择指数**：在下拉菜单中选择要查看的指数
2. **选择周期**：选择日线、周线或月线
3. **选择时间范围**：选择要显示的天数
4. **刷新数据**：点击"刷新数据"按钮获取最新数据
5. **查看实时行情**：点击"实时行情"按钮查看所有指数的实时数据

### 主要功能区域

#### 1. 信息卡片
显示当前价格、涨跌幅、成交量、成交额等关键指标

#### 2. K线图表
- 显示价格走势和成交量
- 支持缩放和拖动
- 显示MA均线

#### 3. 技术指标信号
显示各种技术指标的最新值和信号：
- MA（移动平均线）
- MACD（指数平滑异同移动平均线）
- KDJ（随机指标）
- RSI（相对强弱指标）

#### 4. 数据分析
显示统计分析、波动率分析、连涨连跌等信息

## 三、API使用示例

### 使用curl

```bash
# 获取实时行情
curl http://localhost:8000/api/realtime/sh000001

# 获取历史数据
curl "http://localhost:8000/api/historical/sh000001?start_date=2024-01-01&end_date=2024-12-31"

# 获取技术指标
curl http://localhost:8000/api/indicators/sh000001

# 获取综合分析
curl http://localhost:8000/api/analysis/sh000001
```

### 使用Python

```python
import requests

# 获取实时行情
response = requests.get('http://localhost:8000/api/realtime/sh000001')
data = response.json()
print(f"当前价格: {data['data']['current']}")
print(f"涨跌幅: {data['data']['pct_change']}%")

# 获取历史数据
response = requests.get(
    'http://localhost:8000/api/historical/sh000001',
    params={
        'start_date': '2024-01-01',
        'end_date': '2024-12-31',
        'period': 'daily'
    }
)
data = response.json()
print(f"获取到 {data['count']} 条数据")
```

## 四、常见问题

### Q1: 启动时提示端口被占用

**解决方法**：修改 `.env` 文件中的 `PORT` 参数

```env
PORT=8001
```

### Q2: 获取数据失败

**可能原因**：
1. 网络连接问题
2. 数据源API限制

**解决方法**：
1. 检查网络连接
2. 稍后重试
3. 查看日志文件 `logs/app.log`

### Q3: Redis连接失败

**说明**：Redis是可选的，如果没有安装Redis，系统会自动禁用缓存功能，不影响主要功能使用。

**如果需要使用Redis**：
1. 安装Redis
2. 启动Redis服务
3. 在 `.env` 中配置Redis连接信息

### Q4: 技术指标显示不全

**原因**：数据量不足，某些指标需要足够的历史数据才能计算

**解决方法**：增加查询的时间范围

### Q5: 图表不显示

**可能原因**：
1. 浏览器不支持
2. JavaScript被禁用
3. 网络问题导致ECharts库加载失败

**解决方法**：
1. 使用现代浏览器（Chrome、Firefox、Edge）
2. 启用JavaScript
3. 检查网络连接

## 五、数据说明

### 支持的指数

| 代码 | 名称 | 说明 |
|------|------|------|
| sh000001 | 上证指数 | 上海证券交易所综合指数 |
| sz399001 | 深证成指 | 深圳证券交易所成份指数 |
| sz399006 | 创业板指 | 创业板综合指数 |
| sh000688 | 科创50 | 科创板50成份指数 |
| sh000300 | 沪深300 | 沪深两市300只股票 |
| sh000905 | 中证500 | 中证500指数 |
| sh000852 | 中证1000 | 中证1000指数 |

### 时间周期

- **daily**：日线数据
- **weekly**：周线数据
- **monthly**：月线数据

### 技术指标说明

#### MA（移动平均线）
- 计算周期：5、10、20、30、60、120、250日
- 用途：判断趋势方向

#### MACD
- DIF：快线
- DEA：慢线
- HIST：柱状图
- 金叉：DIF上穿DEA，看涨信号
- 死叉：DIF下穿DEA，看跌信号

#### KDJ
- K值、D值、J值
- 超买：K>80, D>80
- 超卖：K<20, D<20

#### RSI（相对强弱指标）
- 计算周期：6、12、24日
- 超买：RSI>70
- 超卖：RSI<30

## 六、性能优化建议

### 1. 使用Redis缓存

安装并启动Redis可以显著提升响应速度：

```bash
# macOS
brew install redis
brew services start redis

# Ubuntu
sudo apt-get install redis-server
sudo systemctl start redis

# Windows
# 下载Redis for Windows并启动
```

### 2. 调整数据更新频率

在 `.env` 文件中设置：

```env
DATA_UPDATE_INTERVAL=5  # 秒
```

### 3. 限制历史数据范围

查询大量历史数据时，建议分批查询或限制时间范围。

## 七、开发建议

### 添加新的技术指标

1. 在 `src/indicators/calculator.py` 中添加计算方法
2. 在 `calculate_all_indicators` 方法中调用
3. 在前端更新显示逻辑

### 添加新的指数

1. 在 `src/constants.py` 的 `SUPPORTED_INDICES` 中添加
2. 重启应用即可

### 自定义分析功能

在 `src/analysis/analyzer.py` 中添加新的分析方法。

## 八、注意事项

1. **数据仅供参考**：本系统提供的数据和分析仅供学习研究，不构成投资建议
2. **遵守使用规范**：请遵守数据源的使用条款，避免频繁请求
3. **数据延迟**：实时数据可能存在延迟
4. **风险提示**：投资有风险，入市需谨慎

## 九、获取帮助

- 查看完整文档：[README.md](README.md)
- 查看需求分析：[需求分析.md](需求分析.md)
- API文档：http://localhost:8000/docs
- 提交Issue：在项目仓库提交问题

## 十、下一步

系统启动成功后，你可以：

1. 浏览Web界面，熟悉各项功能
2. 尝试不同的指数和时间周期
3. 查看技术指标和分析结果
4. 通过API接口集成到自己的应用中
5. 根据需要自定义和扩展功能

祝使用愉快！
